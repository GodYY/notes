# 模式

- 正常模式：默认模式，或按`ESC`进入。
- 插入模式：正常模式下，按`i`进入。在光标处插入文本。
- 可视模式：正常模式下，按`v`进入。通过移动光标勾选文本。
- 替换模式：正常模式下，按`r`或`R`进入。替换光标处的文本。
- 命令模式：正常模式下，按`:`进入。

# 基本操作

## 移动光标

```
      ** 要移动光标，请依照说明分别按下 h、j、k、l 键。 **

             ^
             k              提示： h 的键位于左边，每次按下就会向左移动。
       < h       l >               l 的键位于右边，每次按下就会向右移动。
             j                     j 键看起来很象一支尖端方向朝下的箭头。
             v
```

## 退出

按`ESC`退出到 **Normal** 模式，输入:

- `:q` 没有修改直接退出
- `:q!` 放弃修改强制退出
- `:wq` 保存修改退出

## 删除

在 **Normal** 模式下，按下`x`可以删除光标所在位置的字符，`X`可删除光标所在位置之前的字符。

## 插入和添加

**Normal** 模式下。

`a`在光标所在位置之后添加文本。`A`在光标所在行末添加文本。

`i`在光标所在位置之前添加文本。`I`在光标所在行首添加文本。

## 撤销（undo）

`u`: 撤销最后执行的命令

`U`: 撤销对整行的修改

## 恢复（redo）

`CTRL-R`: 恢复以前的操作结果。

# 移动光标

`0`: 移动到行首

`$`：移动到行尾

`w`：移动到下一个单词的第一个字符处

`e`：移动到当前或下一个单词的最后一个字符处

`b`：移动到当前或前一个单词的第一个字符处

# 命令

许多改变文本的命令都由一个“操作符”和“动作”构成。

在正常模式下修改命令的格式是：
$$
operator \quad [number] \quad motion
$$
其中：

- `operator` - 操作符，代表要做的事情，比如"d"代表删除。
- `[number]` - 可以附加的数字，代表动作重复的次数。
- `motion` - 动作，代表在所操作文本上的移动，例如"w"代表单词，"$"代表行尾。

## 置入

要重新置入已经删除的文本内容，请按`p`键。该操作可以将已删除的文本内容置于光标之后。如果最后一次删除的是一整行，那么该行将置于当前光标所在行的下一行。

## 替换

### 字符

按`r`键后输入字符可以替换掉光标所在位置的字符。

按`R`键后输入字符以连续替换光标后的文本，知道按`ESC`退出。

### 文本

`:s/old/new` 在一行内替换头一个字符串`old`为`new`。

`:s/old/new/g` 在一行内替换所有的字符串`old`为`new`。

`:#,#s/old/new/g` 在两行之间替换所有的字符串`old`为`new`。

`:%s/old/new/g` 在整个文件内替换所有的字符串`old`为`new`。

`:%s/old/new/gc` 同上，替换前做确认询问。

## 更改

更改类命令允许你改变从当前光标所在位置直到动作指示的位置中间的文本。

比如输入`ce`可以替换从当前光标到单词末尾的内容；输入`c$`可以替换从当前光标到行尾的内容。

更改类命令格式：
$$
c \quad [number] \quad motion
$$

## 定位及文件状态

输入`CTRL-G`可以显示当前编辑文件中当前光标所在行位置以及文件状态信息。

输入`G`直接跳转到文件中的某一指定行。（默认为最后一行）

输入`gg`直接跳转到文件第一行。

输入`CTRL-O`跳转光标到前一个定位位置；输入`CTRL-I`跳转光标到后一个定位位置。

## 搜索

输入`/`并加上一个字符串可以在当前文件中查找该字符串。

要查找同上一次的字符串，输入`n`；要向相反方向查找，输入大写`N`。

如果想直接逆向查找字符串，用`?`代替`/`。

输入`CTRL-O`回到前一个查找到的位置，输入`CTRL-I`跳转到较新的位置。

## 查找配对的括号

输入`%` 可以查找配对的括号 )、]、}。

## 执行外部命令

输入`:!command` 可以执行该外部命令`command`。

例如，`:!ls`。

## 保存文件

将文件的改动保存到指定文件中：

```
:w FILENAME
```

## 可视化选择文本内容

```
v motion
```

正常模式下按`v`进入可视模式，然后通过移动光标（motion）可勾选文本内容，然后可以点按操作符对选中文本进行操作。

例如，`d`删除选中文本。

### 保存文件部分内容

选择文本内容后，按`:`，将在屏幕底部看到`:'<,'>`，继续键入`w FILENAME`。

## 读取文件内容或外部命令输出

输入`:r FILENAME`，读取文件内容并插入到光标后。

输入`:r !command`，读取外部命令输出插入到光标后。

## 打开类

输入`o`将在光标下方打开新的一行并进入插入模式。

输入`O`将在光标上方打开新的一行并进入插入模式。

## 附加类

输入`a`可在光标之后插入文本。

输入`A`可在光标所在行的最后一个字符之后插入文本。

## 复制粘贴

`y`复制选中文本。

`yy`复制光标所在整行，包括行尾换行符。

也可以把`y`当作操作符使用，例如`yw`可以复制一个单词。

## 设置类

`:set`查看当前设置选项。

`:set xxx`设置xxx选项。

`:set ic/ignorecase`查找时忽略大小写。

`:set hls/hlsearch`高亮显示所有匹配短语。

`:set is/incsearch`查找短语时显示部分匹配。

`:set noxxx`关闭xxx选项。

`:nohls`移除匹配项的高亮显示。

# 删除

**Normal 模式下**。

下列 **n** 默认为1。

`dw`：从光标处删除至一个单词的末尾。

`d[n]w`：删除 **n** 个单词。

`d$`：从光标处删除至一行的末尾。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        `d[n]d/[n]dd`：删除 **n** 行。



# 补全功能

补全对许多命令都有效。`CTRL-D`显示匹配的列表，`<TAB>`浏览和补全。

首先，确保 Vim 不是以兼容模式运行：`:set nocp`

查看当前目录下已经存在哪些文件：`:!ls`

输入一个命令的起始部分，例如：`:e`

按`CTRL-D`，Vim 会显示以 e 开始的命令的列表。

按`<TAB>`，Vim 会补全命令，例如`:edit`。继续按`<TAB>`可在之前显示的列表中浏览选取。

接着添加一个空格，以及一个已有文件的文件名的起始部分，例如：`:edit FIL`

接着按`<TAB>`，Vim 会补全文件名。

# 帮助信息

Vim 拥有一个细致全面的在线帮助系统。要启动该帮助系统，请选择如下三种方法之一：

- 按下 <HELP> 键（如果键盘上有）
- 按下<F1>键（如果键盘上有）
- 输入`:help <回车>`

输入`CTRL-W CTRL-W`，在窗口间跳转。`:q <回车>`关闭帮助窗口。

提供一个正确的参数给":help"命令，可以找到关于该主题的帮助。

# 创建启动脚本

Vim 的大部分功能特性都没有缺省启用，为了使用更多的特性，你得创建一个 **vimrc** 文件。

1. 编辑 **vimrc** 文件

   - `:edit ~/.vimrc` UNIX
   - `:edit $VIM/_vimrc` MS-Windows

2. 读取 **vimrc** 示例文件的内容：

   ```
   :r $VIMRUNTIME/vimrc_example.vim
   ```

3. 保存文件`:write`

下次启动 Vim 时，编辑器就会有了语法高亮的功能。

你可以把喜欢的各种设置添加到 **vimrc** 文件中。了解更多信息`:help vimrc-intro`。

**vimrc** 文件中可以包含所有你在`:`后输入的命令。最简单的例子是设置选项。例如，你希望 Vim 在每次启动的时候都启用`incsearch`选项，添加`set incsearch`到 **vimrc** 文件中。

> 注意：
>
> 如果重启 Vim 后并没有读取到 “defaults.vim” 中的选项。需要在".vimrc"文件起始处添加：
>
> ```
> unlet! skip_defaults_vim
> ```
>
> 来禁用跳过默认配置的读取。

更多的编写 Vim 脚本的信息，使用`:help usr_41.txt`查看。